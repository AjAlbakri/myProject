<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Romance Chat</title>
 
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='styles.css') }}">
</head>

    <body class="light">

        <header class="light" id="header">
            <nav>
                <ul class="top-nav">
                    <li><a href="/">Home</a></li>
                    <li><a href="/about">About</a></li>
                   
                    <li><a href="/settings">Settings</a></li>
                    <li><a href="/elderly">Elderly</a></li>
        
                  
                </ul>
            </nav>
            <h1>Welcome to the <span class="chatbot-title">Romance Chatbot</span></h1>
        </header>
        
        
        
        
        <div class="sidebar hidden" id="sidebar">
            <ul>
                <li><a href="/conversation?genre=romance">Romance</a></li>
                <li><a href="/conversation?genre=thriller">Thriller</a></li>
                <li><a href="/conversation?genre=fantasy">Fantasy</a></li>
             
            </ul>
            
        </div>
          
        
          
            <div class="chat-container light">
               
                <div id="chat-log" class="chat-log light" style="background-color: #f7f7f7;"></div>
                <div class="input-container">
                    <input type="text" id="user-input" class="user-input" placeholder="Type your message...">
                    <button onclick="sendMessage()" class="send-button">Send</button>
                </div>
               
                
            
            </div>
        </div>

<script>
var currentConversationId = null;
var swearWords = ['fuck', 'shit', 'asshole', 'bitch', 'bastard', 'damn', 'crap', 'ass', 'dick', 'pussy', 'pussio'];








function sendMessage() {
    var userInput = document.getElementById('user-input').value.trim().toLowerCase();
    if (userInput !== '') {
        if (checkSwearWords(userInput)) {
            alert("Sorry, the message contains inappropriate language. Please refrain from using swear words.");
            return;
        }
        appendMessage('user', userInput);
        document.getElementById('user-input').value = '';
        
        // Check if the user input contains romance-related keywords
        if (isRomanceRequest(userInput)) {
            // If related to romance, generate a romance story
            fetch('/get', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ msg: userInput })
            })
            .then(response => response.json())
            .then(data => {
                appendMessage('bot', data.response);
            })
            .catch(error => {
                console.error('Error:', error);
            });
        } else {
            
            appendMessage('bot', "Sorry, I only generate romance stories, books, poems, or poetry.");
        }
    }
}

function isRomanceRequest(userInput) {
    
    var romanceKeywords = ['romance', 'love', 'heart', 'couple', 'poem', 'poetry', 'book', 'story'];
    var userInputLower = userInput.toLowerCase();
    return romanceKeywords.some(keyword => userInputLower.includes(keyword));
}

function appendMessage(sender, message, options) {
    var chatLog = document.getElementById('chat-log');
    var messageElement = document.createElement('div');
    messageElement.classList.add('message', sender === 'user' ? 'user-message' : 'bot-message');
    messageElement.textContent = message;
    chatLog.appendChild(messageElement);
    chatLog.scrollTop = chatLog.scrollHeight;


    if (options && options.length > 0) {
        var optionsContainer = document.createElement('div');
        optionsContainer.classList.add('options-container');
        options.forEach(option => {
            var button = document.createElement('button');
            button.textContent = option.label;
            button.onclick = function() {
             
                sendMessage(option.value);
             
                chatLog.removeChild(optionsContainer);
            };
            optionsContainer.appendChild(button);
        });
        chatLog.appendChild(optionsContainer);
    }


    if (sender === 'bot') {
        speak(message);
    }
}



function checkSwearWords(input) {
    for (var i = 0; i < swearWords.length; i++) {
        if (input.includes(swearWords[i])) {
            return true;
        }
    }
    return false;
}

window.onload = function() {
    var savedTheme = localStorage.getItem('chat_theme');
    if (savedTheme) {
        changeTheme();
    }
};
</script>
</body>
</html>
